<p id="notice"><%= notice %></p>
<h1>Wishlist</h1>

<%= form_tag called_dibs_wishlists_path, method: :put do%>

<div class ="check_box">
  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Price</th>
        <th>Info</th>
        <th>Call Dibs?</th>
        <th colspan="4"></th>
      </tr>
    </thead>
<!-- https://www.youtube.com/watch?v=53s2_WQkhhw -->
    <tbody>
    <% for wishlist in @wishlist %>
        <tr>
          <td><%= wishlist.title %></td>
          <td><%= wishlist.price %></td>
          <td><%= wishlist.info %></td>
            <!-- checks to see who is looking at form -->
            <% if current_user == @user %>
                <!-- need to set remove for the current user -->
                <% if wishlist.dibs_user != nil %>
                <td> This spot has been taken by <%= User.find(wishlist.dibs_user).username %>  <%= link_to "Remove", remove_wishlists_path(id: wishlist.id), method: :put %></td>
                <% else %>
                <td> Get your friends to call dibs! </td>
                <%end %>
            <% elsif not Friendship.exist?(current_user,@user)%>
                <td> You are not friends with this user yet </td>
            <%else %>
            <!-- goes into who has the check-->
                <% if wishlist.dibs_user == current_user.id %>
                    <!-- need to find a way to change from true to false -->
                    <td>You have called dibs <%= link_to "Remove", remove_wishlists_path(id: wishlist.id), method: :put %> </td>
                    <!-- this line is one I need to figure out how to change -->
                <% else %>
                    <% if wishlist.dibs_user != nil %>
                    <!-- this line will show who has it dibbed -->
                      <td> This spot has been taken by <%= User.find(wishlist.dibs_user).username %> </td>
                    <!-- once i figure out how to set it -->
                    <% else %>
                      <td><%= check_box_tag "dibcheck[]", wishlist.id %></td>
                    <% end %>

                <% end %>
              <!-- -->
            <% end %>

        <% if current_user.id == @user.id %>
          <td><%= link_to 'Show', wishlist %></td>
          <td><%= link_to 'Edit', edit_wishlist_path(wishlist) %></td>
          <td><%= link_to 'Destroy', wishlist, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
        <% end %>
      <% end %>
    </tbody>
             
  </table>
</div>

<br>
<a class="waves-effect waves-light btn"><%= submit_tag "DIBS!" %></a>

<%= link_to 'New Wishlist Item', new_wishlist_path %>
<br/>
<% end %>